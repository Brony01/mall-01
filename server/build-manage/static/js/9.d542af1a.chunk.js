(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[9],{1296:function(t,e,a){"use strict";a.r(e);var r=a(0),s=a.n(r),n=a(23),o=(a(254),a(177)),c=(a(790),a(878)),d=(a(58),a(20)),l=(a(92),a(24)),i=(a(712),a(763)),u=a(50);const{Text:m}=i.a;class h extends r.Component{constructor(){super(...arguments),this.state={orderId:this.props.location.state.order,order:{},products:[],loading:!0},this.handleCancelOrder=async()=>{const{orderId:t}=this.state,e=await Object(u.f)({orderId:t});0===e.status?(l.a.success("\u8ba2\u5355\u5df2\u53d6\u6d88"),this.setState({order:{...this.state.order,status:"\u5df2\u53d6\u6d88"}})):l.a.error(e.msg||"\u53d6\u6d88\u8ba2\u5355\u5931\u8d25")},this.handleShipOrder=async()=>{const{orderId:t}=this.state;try{0===(await Object(u.t)({orderId:t,status:"\u5f85\u6536\u8d27"})).status?(l.a.success("\u8ba2\u5355\u5df2\u53d1\u8d27"),this.setState({order:{...this.state.order,status:"\u5f85\u6536\u8d27"}})):l.a.error("\u53d1\u8d27\u5931\u8d25")}catch(e){l.a.error("\u53d1\u8d27\u5931\u8d25")}},this.handleReject=async()=>{const{orderId:t,order:e}=this.state;let a="\u9000\u8d27\u9000\u6b3e\u672a\u901a\u8fc7";"\u552e\u540e\u5904\u7406\u4e2d(\u4ec5\u9000\u6b3e)"===e.status&&(a="\u4ec5\u9000\u6b3e\u672a\u901a\u8fc7");const r=await Object(u.t)({orderId:t,status:a});0===r.status?(l.a.success("\u5df2\u62d2\u7edd"),this.setState({order:{...this.state.order,status:a}})):l.a.error(r.msg||"\u64cd\u4f5c\u5931\u8d25")},this.handleApprove=async()=>{const{orderId:t,order:e}=this.state;let a="\u9000\u8d27\u9000\u6b3e\u901a\u8fc7";"\u552e\u540e\u5904\u7406\u4e2d(\u4ec5\u9000\u6b3e)"===e.status&&(a="\u4ec5\u9000\u6b3e\u901a\u8fc7");const r=await Object(u.t)({orderId:t,status:a});0===r.status?(l.a.success("\u5df2\u901a\u8fc7"),this.setState({order:{...this.state.order,status:a}})):l.a.error(r.msg||"\u64cd\u4f5c\u5931\u8d25")}}componentDidMount(){const t=this.state.orderId;Object(u.l)(t).then(t=>{0===t.status?this.setState({order:t.data,products:t.data.products,loading:!1}):l.a.error("\u83b7\u53d6\u8ba2\u5355\u8be6\u60c5\u5931\u8d25")})}render(){const{orderId:t,products:e,order:a}=this.state;return s.a.createElement(o.a,{title:"\u8ba2\u5355\u53f7: ".concat(t)},s.a.createElement(d.a,{onClick:()=>this.props.history.push("/order-manage")},"\u8fd4\u56de"),s.a.createElement(c.a,{itemLayout:"vertical",dataSource:e,renderItem:t=>s.a.createElement(c.a.Item,{key:t._id},s.a.createElement(c.a.Item.Meta,{title:"\u5546\u54c1\u540d\uff1a".concat(t.name," | \u5546\u54c1\u63cf\u8ff0\uff1a").concat(t.desc),description:"\u4ef7\u683c: \xa5".concat(t.price," | \u6570\u91cf: ").concat(t.quantity)}),s.a.createElement("img",{src:t.imgs[0],alt:t.name,style:{width:"50px",marginTop:"10px"}}))}),s.a.createElement(m,null,"\u539f\u603b\u91d1\u989d: \xa5",a.originalAmount),s.a.createElement("br",null),s.a.createElement(m,null,"\u6298\u6263\u540e\u603b\u91d1\u989d: \xa5",a.totalAmount),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(m,null,"\u8ba2\u5355\u72b6\u6001: ",a.status||"\u672a\u77e5\u72b6\u6001"),"\u5f85\u53d1\u8d27"===a.status&&s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{type:"primary",onClick:this.handleShipOrder},"\u53d1\u8d27"),s.a.createElement(d.a,{onClick:this.handleCancelOrder,style:{marginLeft:10}},"\u53d6\u6d88\u8ba2\u5355")),("\u552e\u540e\u5904\u7406\u4e2d(\u9000\u8d27\u9000\u6b3e)"===a.status||"\u552e\u540e\u5904\u7406\u4e2d(\u4ec5\u9000\u6b3e)"===a.status)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{type:"danger",onClick:this.handleReject},"\u62d2\u7edd"),s.a.createElement(d.a,{type:"primary",onClick:this.handleApprove,style:{marginLeft:10}},"\u901a\u8fc7")))}}var p=Object(n.g)(h),g=(a(180),a(122)),E=(a(255),a(178)),y=a(35);class I extends r.Component{constructor(){super(...arguments),this.state={orders:[],loading:!0},this.columns=[{title:"\u8ba2\u5355\u53f7",dataIndex:"_id",key:"_id"},{title:"\u7528\u6237ID",dataIndex:"userId",key:"userId"},{title:"\u539f\u603b\u91d1\u989d",dataIndex:"originalAmount",key:"originalAmount"},{title:"\u6298\u6263\u540e\u603b\u91d1\u989d",dataIndex:"totalAmount",key:"totalAmount"},{title:"\u72b6\u6001",dataIndex:"status",key:"status"},{title:"\u64cd\u4f5c",key:"action",render:(t,e)=>s.a.createElement("span",null,s.a.createElement(y.b,{to:{pathname:"/order-manage/detail",state:{order:e._id}}},"\u67e5\u770b"))}]}componentDidMount(){Object(u.e)().then(t=>{0===t.status?this.setState({orders:t.data,loading:!1}):console.log(t.msg)})}render(){const{orders:t,loading:e}=this.state;return s.a.createElement(g.a,{spinning:e},s.a.createElement(E.a,{dataSource:t,columns:this.columns,rowKey:"_id"}))}}var b=Object(n.g)(I);e.default=class extends r.Component{constructor(){super(...arguments),this.state={}}render(){return s.a.createElement(n.d,null,s.a.createElement(n.b,{exact:!0,path:"/order-manage",component:b}),s.a.createElement(n.b,{path:"/order-manage/detail",component:p}),s.a.createElement(n.a,{to:"/order-manage"}))}}}}]);