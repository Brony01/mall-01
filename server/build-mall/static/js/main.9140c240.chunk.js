(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{314:function(e,t,a){e.exports=a(551)},358:function(e,t){e.exports={serverAddress:"http://47.94.129.28:8082",baseURl:"/api",imgUrl:"http://127.0.0.1:8081/api/upload/"}},492:function(e,t,a){},499:function(e,t,a){},505:function(e,t,a){},521:function(e,t,a){},523:function(e,t,a){},545:function(e,t,a){},551:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(8),c=a.n(s),l=(a(319),a(18)),o=a(35),i=a(32),d=a(25),m=a(240),u=a(57),p=a.n(u),h=(a(324),a(87)),g=a.n(h);var E={set:(e,t)=>{g.a.set(e,t)},get:e=>g.a.get(e),remove:e=>{g.a.remove(e)},clearAll:()=>{g.a.clearAll()}},y=a(94),f=a(224);a(335);const b=g.a.get("user_key")||{};var v=Object(y.combineReducers)({getHeadTitle:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u9996\u9875",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"set_head_title":return t.data;default:return e}},loginUserInfo:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,{type:t,data:a}=arguments.length>1?arguments[1]:void 0;switch(t){case"login_user_info":return a;case"register_user_info":case"log_out":return{};default:return e}}});var I=function(){let e=Object(y.applyMiddleware)(f.a);return Object(y.createStore)(v,e)}(),x=(a(40),a(14)),S=(a(153),a(44)),w=(a(117),a(69)),k=(a(154),a(7)),C=(a(42),a(5)),_=a(225),O=a.n(_);a(358);const j=O.a.create({baseURL:"http://47.94.129.28:8082/api",timeout:3e5,headers:{"Content-Type":"application/json",Authorization:window.localStorage.getItem("token")}});j.setToken=e=>{j.defaults.headers.Authorization=e,window.localStorage.setItem("token",e)};let T=!1,A=[];function D(e,t){const a=new URLSearchParams(t).toString();return"".concat(e,"?").concat(a,"&t=").concat(new Date)}j.interceptors.response.use(e=>{const{status:t}=e.data;if(1e3===t){const{config:t}=e;return T?new Promise(e=>{A.push(a=>{t.baseURL="",t.headers.Authorization=a,e(j(t))})}):(T=!0,j.post("/refreshtoken").then(e=>e.data).then(e=>{const{token:a}=e;return j.setToken(a),t.headers.Authorization=a,t.baseURL="",A.forEach(e=>e(a)),A=[],j(t)}).catch(e=>{console.error("refreshtoken error =>",e),window.location.href="/"}).finally(()=>{T=!1}))}return e},e=>(C.a.error("\u8bf7\u6c42\u51fa\u9519".concat(e.message)),Promise.reject(e)));var R=function(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((n,s)=>{if("GET"===a){const a=D(e,r);t=j.get(a)}else t=j.post(e,r);t.then(e=>{e.data&&0===e.data.status||C.a.error(e.data.msg),n(e.data)}).catch(e=>{const{data:t}=e;t&&t.msg?C.a.error("\u8bf7\u6c42\u51fa\u9519".concat(t.msg)):C.a.error("\u8bf7\u6c42\u51fa\u9519".concat(e.message))})})};const L=e=>R("/manage/category/list","GET",e),z=e=>R("/manage/product/hot","GET",e),P=e=>R("/manage/role/add","POST",e),U=e=>R("/manage/role/list","GET",e),N=e=>R("/order/create","POST",e),M=e=>R("/order/update","POST",e),F=e=>R("/coupons/user","GET",e),q=e=>R("/manage/product/seckill","GET",e);a(400);var W=a(239);const{TreeNode:B}=W.a;r.Component;let G;class H extends r.Component{constructor(){super(),this.state={visible:!1,confirmLoading:!1,loading:!1,tableData:[],role:{menus:[]},roles:[],searchText:""},this.showModal=()=>{this.setState({visible:!0})},this.roleModal=()=>{this.roleRef.current.showModal()},this.handelAddUser=e=>{e.preventDefault(),this.props.form.validateFields(async(e,t)=>{if(!e){this.setState({confirmLoading:!0});const e=await P(t);C.a.success("\u6dfb\u52a0\u6210\u529f\uff01"),this.setState(t=>({roles:[...t.roles,e.data],visible:!1,confirmLoading:!1})),this.props.form.resetFields(),this.getUserList()}})},this.deleteUser=async e=>{this.setState({loading:!0});const{_id:t}=e;var a;await(a={_id:t},R("/manage/role/delete","POST",a))&&(this.setState({loading:!1}),C.a.success("\u5220\u9664\u6210\u529f\uff01"),this.getUserList())},this.handleCancel=()=>{this.props.form.resetFields(),this.setState({visible:!1,confirmLoading:!1})},this.getUserList=async()=>{this.setState({loading:!0});const e=await U(),{data:t}=e;this.setState({loading:!1,tableData:t})},this.initializeRoles=async()=>{const e=await U();if(0===e.status){this.setState({roles:e.data});const t=e.data.find(e=>"\u666e\u901a\u7528\u6237"===e.name);t?G=t._id:this.createDefaultRole()}},this.createDefaultRole=async()=>{0===(await P({name:"\u666e\u901a\u7528\u6237"})).status?(C.a.success('\u9ed8\u8ba4\u89d2\u8272"\u666e\u901a\u7528\u6237"\u5df2\u521b\u5efa'),this.initializeRoles()):C.a.error("\u521b\u5efa\u9ed8\u8ba4\u89d2\u8272\u5931\u8d25")},this.rowSelection=()=>({columnTitle:"\u7ba1\u7406",type:"radio",selectedRowKeys:this.state.role._id,onSelect:e=>{this.setState({role:e})}}),this.tableOnRow=e=>({onClick:t=>{this.setState({role:e})}}),this.filterRoles=()=>{const{tableData:e,searchText:t}=this.state;return e.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))},this.roleRef=n.a.createRef(),this.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",sorter:(e,t)=>e.create_time-t.create_time,sortDirections:["descend","ascend"],render:e=>p()(e).format("YYYY-MM-DD")},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",sorter:(e,t)=>e.create_time-t.create_time,sortDirections:["descend","ascend"],render:e=>p()(e).format("YYYY-MM-DD HH:mm:ss")},{title:"\u64cd\u4f5c",render:e=>n.a.createElement(x.a,{type:"link",onClick:()=>this.deleteUser(e)},"\u5220\u9664")}]}componentDidMount(){this.getUserList()}}S.a.create({name:"normal_login"})(H);var Y=function(e){const{href:t,text:a,target:r}=e.params||{};return n.a.createElement("a",{href:t,target:r},a)};a(492);class V extends r.Component{constructor(){super(...arguments),this.state={params:{href:"https://github.com/Brony01",target:"_black",text:"Bronya Zaychik"}},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields((e,t)=>{e||(t=Object.assign(t,{username:btoa(t.username),password:btoa(t.password)}),this.props.getLoginUserInfo(t))})},this.validatorPwd=(e,t,a)=>{t?"admin"===t?a():t.length<8||t.length>16?a("\u5bc6\u7801\u957f\u5ea6\u5e94\u4e3a8-16\u4f4d\uff01"):/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,16}$/.test(t)||a("\u5bc6\u7801\u5fc5\u987b\u5305\u542b\u5927\u5c0f\u5199\u5b57\u6bcd\u53ca\u6570\u5b57\uff01"):a("\u8bf7\u8f93\u5165\u5bc6\u7801\uff01"),a()}}render(){const{userInfo:e}=this.props;if(e._id)return n.a.createElement(i.a,{to:"/mainpage/home"});const{getFieldDecorator:t}=this.props.form;return n.a.createElement("div",{className:"login"},n.a.createElement("div",{className:"header"}),n.a.createElement("div",{className:"content"},n.a.createElement("section",{className:"login-form"},n.a.createElement("div",{className:"login-label"},n.a.createElement("span",null,"\u4fe1\u606f\u7ba1\u7406\u7cfb\u7edf")),n.a.createElement(S.a,{onSubmit:this.handleSubmit,className:""},n.a.createElement(S.a.Item,null,t("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u53ea\u80fd\u542b\u6709\u6570\u5b57\u3001\u82f1\u6587\u3001\u4e0b\u5212\u7ebf!"}],initialValue:"admin"})(n.a.createElement(w.a,{prefix:n.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),n.a.createElement(S.a.Item,null,t("password",{rules:[{validator:this.validatorPwd}],initialValue:"admin"})(n.a.createElement(w.a.Password,{prefix:n.a.createElement(k.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))),n.a.createElement(S.a.Item,null,n.a.createElement(x.a,{type:"primary",htmlType:"submit",className:"login-btn",onClick:this.onSubmit},"\u767b\u5f55")),n.a.createElement(o.b,{to:"/register"},"\u6ca1\u6709\u8d26\u53f7\uff1f\u70b9\u51fb\u6ce8\u518c")))),n.a.createElement("div",{className:"footer"},n.a.createElement("div",{className:"content"},"Made with \u2764 by Brony",n.a.createElement(Y,{params:this.state.params}))))}}const Z=S.a.create({name:"normal_login"})(V),K={getLoginUserInfo:e=>async t=>{try{const r=await(a=e,R("/login","POST",a));0===r.status?(C.a.success("\u767b\u5f55\u6210\u529f\uff01"),t({type:"login_user_info",data:r.data}),E.set("user_key",r.data),E.set("token",r.token)):C.a.error("\u767b\u5f55\u5931\u8d25\uff01")}catch(r){console.error("\u83b7\u53d6\u767b\u5f55\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff1a",r),C.a.error("\u83b7\u53d6\u767b\u5f55\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff01")}var a}};var X=Object(d.b)(e=>({userInfo:e.loginUserInfo}),K)(Z);a(499);class $ extends r.Component{constructor(){super(...arguments),this.state={redirectToLogin:!1},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields((e,t)=>{e||this.props.registerUserInfo(t,()=>{C.a.success("\u6ce8\u518c\u6210\u529f\uff01"),this.setState({redirectToLogin:!0}),this.props.history.push("/login")})})}}render(){const{getFieldDecorator:e}=this.props.form;return this.state.redirectToLogin?n.a.createElement(i.a,{to:"/login"}):n.a.createElement("div",{className:"register"},n.a.createElement("div",{className:"header"},"\u6ce8\u518c\u9875\u9762"),n.a.createElement("div",{className:"content"},n.a.createElement("section",{className:"register-form"},n.a.createElement(S.a,{onSubmit:this.handleSubmit},n.a.createElement("div",{className:"register-label"},n.a.createElement("span",null,"\u4fe1\u606f\u7ba1\u7406\u7cfb\u7edf")),n.a.createElement(S.a.Item,null,e("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"}]})(n.a.createElement(w.a,{prefix:n.a.createElement(k.a,{type:"user"}),placeholder:"\u7528\u6237\u540d"}))),n.a.createElement(S.a.Item,null,e("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"},{min:8,message:"\u5bc6\u7801\u81f3\u5c11\u4e3a8\u4f4d"},{max:16,message:"\u5bc6\u7801\u6700\u591a\u4e3a16\u4f4d"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"\u5bc6\u7801\u9700\u5305\u542b\u5927\u5c0f\u5199\u5b57\u6bcd\u53ca\u6570\u5b57"}]})(n.a.createElement(w.a.Password,{prefix:n.a.createElement(k.a,{type:"lock"}),type:"password",placeholder:"\u5bc6\u7801"}))),n.a.createElement(S.a.Item,null,e("email",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u5730\u5740!"},{type:"email",message:"\u90ae\u7bb1\u5730\u5740\u683c\u5f0f\u9519\u8bef!"}]})(n.a.createElement(w.a,{prefix:n.a.createElement(k.a,{type:"mail"}),type:"email",placeholder:"\u90ae\u7bb1"}))),n.a.createElement(S.a.Item,{className:"form-item-button"},n.a.createElement(x.a,{type:"primary",htmlType:"submit"},"\u6ce8\u518c"),n.a.createElement(x.a,{type:"default",style:{marginLeft:"0px"},onClick:()=>this.props.history.push("/login")},"\u8fd4\u56de"))))),n.a.createElement("div",{className:"footer"},n.a.createElement("span",null,"Made with \u2764 by Brony")))}}const J=S.a.create({name:"register_form"})($),Q={registerUserInfo:e=>async t=>{try{const r={...e,role_id:G},n=await(a=r,R("/manage/user/add","POST",a));0===n.status?(C.a.success("\u6ce8\u518c\u6210\u529f\uff01"),t({type:"register_user_info",data:n.data})):C.a.error("\u6ce8\u518c\u5931\u8d25\uff1a".concat(n.msg))}catch(r){console.error("\u6ce8\u518c\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff1a",r),C.a.error("\u6ce8\u518c\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff01")}var a}};var ee=Object(i.i)(Object(d.b)(e=>({userInfo:e.loginUserInfo}),Q)(J)),te=(a(500),a(242)),ae=(a(502),a(181)),re=(a(211),a(143));p.a.locale("zh-cn");a(505);var ne=a(23);class se extends r.Component{constructor(){super(...arguments),this.state={env:"production"},this.exitConfirm=e=>{e.preventDefault(),re.a.confirm({title:"\u9000\u51fa",content:"\u786e\u5b9a\u9000\u51fa\uff1f",okText:"\u9000\u51fa",cancelText:"\u53d6\u6d88",confirmLoading:!0,onOk:()=>new Promise((e,t)=>{this.exitTimerID=setTimeout(()=>{E.clearAll(),E.user=null,e(null),this.props.logout(),this.props.history.replace("/")},500)}).catch(()=>console.log("Oops errors!"))})},this.handleSearch=e=>{this.props.history.push({pathname:"/mainpage/products",state:{searchText:e}})}}componentWillUnmount(){clearInterval(this.timerID),clearInterval(this.exitTimerID)}clock(){var e;this.setState({date:(e=new Date,p()(e).format("HH:mm:ss a"))})}render(){const{userInfo:e}=this.props;return n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"header-top"},n.a.createElement("span",null,"Hello\uff0c",e.username),n.a.createElement(ne.a,{style:{width:"60%"},placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0 \u5982: \u624b\u673a",onSearch:this.handleSearch,enterButton:!0}),n.a.createElement(x.a,{type:"link",onClick:this.exitConfirm},"\u9000\u51fa")))}}var ce=Object(d.b)(e=>({headTitle:e.getHeadTitle,userInfo:e.loginUserInfo}),e=>({logout:()=>{e({type:"log_out"})}}))(Object(i.i)(se)),le=a(553),oe=a(554),ie=a(555),de=a(556);a(521);var me=()=>{const e=Object(i.g)(),t=Object(i.h)(),[a,s]=Object(r.useState)("/mainpage/home"),[c,l]=Object(r.useState)({left:0,width:0});Object(r.useEffect)(()=>{s("/mainpage/home"),d("/mainpage/home")},[]),Object(r.useEffect)(()=>{d(t.pathname)},[t.pathname]);const o=[{key:"/mainpage/home",title:"\u9996\u9875",icon:n.a.createElement(le.a,null)},{key:"/mainpage/category",title:"\u5206\u7c7b",icon:n.a.createElement(oe.a,null)},{key:"/mainpage/cart",title:"\u8d2d\u7269\u8f66",icon:n.a.createElement(ie.a,null)},{key:"/mainpage/my",title:"\u6211\u7684",icon:n.a.createElement(de.a,null)}],d=e=>{const t=document.querySelector('a[data-key="'.concat(e,'"]'));if(t){let a=0;"/mainpage/my"===e&&(a=-3);const r=t.offsetLeft+a,n=t.offsetWidth;console.log("Key: ".concat(e,", OffsetLeft: ").concat(r,", OffsetWidth: ").concat(n)),l({left:r,width:n})}};return n.a.createElement("div",{className:"bottom-nav-container"},n.a.createElement(ne.e,{activeKey:a,onChange:t=>{s(t),d(t),e.push(t)},className:"bottom-nav"},o.map(e=>n.a.createElement(ne.e.Item,{key:e.key,title:e.title,icon:e.icon,"data-key":e.key,className:a===e.key?"active":""})),n.a.createElement("div",{className:"slide1",style:{left:c.left,width:c.width}}),n.a.createElement("div",{className:"slide2",style:{left:c.left,width:c.width}})))},ue=class extends r.Component{constructor(){super(...arguments),this.state={params:{href:"123",target:"_black",text:"Bronya Zaychik"}}}render(){return n.a.createElement("div",null,"Made with \u2764React and Node.js by ",n.a.createElement(Y,{params:this.state.params}))}},pe=(a(217),a(141)),he=function(){return n.a.createElement("div",{style:{textAlign:"center",marginTop:"10%"}},n.a.createElement(pe.a,{tip:"\u52aa\u529b\u52a0\u8f7d\u4e2d...",size:"large"}))};a(523);class ge extends r.Component{constructor(){super(...arguments),this.goHome=()=>{this.props.history.replace("/mainpage/home")}}render(){return n.a.createElement("div",{className:"not-found"},n.a.createElement("div",{className:"content"},n.a.createElement("h1",null,"404"),n.a.createElement("h2",null,"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"),n.a.createElement("div",null,n.a.createElement(x.a,{type:"primary",onClick:this.goHome},"\u56de\u5230\u9996\u9875"))))}}var Ee=Object(d.b)(null,null)(ge),ye=(a(55),a(16)),fe=(a(63),a(13)),be=(a(218),a(110)),ve=a(64);const{Search:Ie}=w.a,{TabPane:xe}=be.a;var Se=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(e=>{let{history:t,userInfo:a}=e;const[s,c]=Object(r.useState)([]),[l,o]=Object(r.useState)({hasUnclaimed:!1,hasUnused:!1}),[i,d]=Object(r.useState)({ongoing:[],upcoming:[]});Object(r.useEffect)(()=>{const e=async()=>{try{const e=await q();0===e.status?d(e.data):C.a.error("\u83b7\u53d6\u79d2\u6740\u5546\u54c1\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u79d2\u6740\u5546\u54c1\u5931\u8d25")}};(async()=>{try{const e=await z();0===e.status?c(e.data):C.a.error("\u83b7\u53d6\u70ed\u95e8\u5546\u54c1\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u70ed\u95e8\u5546\u54c1\u5931\u8d25")}})(),(async()=>{const e=a._id;try{const a=await(t=e,R("/coupon/status","GET",t));0===a.status?o(a.data):C.a.error("\u83b7\u53d6\u4f18\u60e0\u5238\u72b6\u6001\u5931\u8d25")}catch(r){C.a.error("\u83b7\u53d6\u4f18\u60e0\u5238\u72b6\u6001\u5931\u8d25")}var t})(),e();const t=setInterval(()=>{e()},1e3);return()=>clearInterval(t)},[]);const m=()=>{t.push("/mainpage/my")},u=e=>{const t=Math.floor((new Date(e)-new Date)/1e3),a=Math.floor(t/3600),r=Math.floor(t%3600/60),n=t%60;return"".concat(a,"\u5c0f\u65f6 ").concat(r,"\u5206\u949f ").concat(n,"\u79d2")},p=e=>{t.push({pathname:"/mainpage/product/detail",state:{productId:e}})};return n.a.createElement("div",{style:{marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement(ne.c,{direction:"vertical",style:{width:"100%"}},n.a.createElement(ne.d,{autoplay:!0,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.2)"}},n.a.createElement(ne.d.Item,{key:1},n.a.createElement("div",null,n.a.createElement("img",{src:"https://res.vmallres.com/uomcdn/CN/cms/202405/ee061dafcb20437aa6e58e174e235c2c.jpg",alt:"HUAWEI Pura70\u7cfb\u5217"}))),n.a.createElement(ne.d.Item,{key:2},n.a.createElement("div",null,n.a.createElement("img",{src:"https://res.vmallres.com/uomcdn/CN/cms/2024-05/5495c7a8405d47998f9804521dd500f8.jpg",alt:"\u534e\u4e3aVision\u667a\u6167\u5c4f4"}))),n.a.createElement(ne.d.Item,{key:3},n.a.createElement("div",null,n.a.createElement("img",{src:"https://res.vmallres.com/uomcdn/CN/cms/2024-05/f1a956d19f5c44a7ab1f2a23db1eeae0.jpg",alt:"HUAWEI MateBook X Pro"})))),n.a.createElement(ye.a,{bordered:!1,title:"\u4f18\u60e0\u5238",style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.2)"}},n.a.createElement(fe.a,null,l.hasUnclaimed&&n.a.createElement(fe.a.Item,{onClick:m},n.a.createElement("div",null,"\u6709\u672a\u9886\u53d6\u7684\u4f18\u60e0\u5238")),l.hasUnused&&n.a.createElement(fe.a.Item,{onClick:m},n.a.createElement("div",null,"\u6709\u672a\u4f7f\u7528\u7684\u4f18\u60e0\u5238")),n.a.createElement(fe.a.Item,{onClick:m},n.a.createElement(x.a,{type:"link"},"\u67e5\u770b\u8be6\u60c5")),n.a.createElement(fe.a.Item,{onClick:async()=>{try{0===(await(e={userId:a._id},R("/coupon/init","POST",e))).status?C.a.success("\u521d\u59cb\u5316\u4f18\u60e0\u5238\u6210\u529f"):C.a.error("\u521d\u59cb\u5316\u4f18\u60e0\u5238\u5931\u8d25")}catch(t){C.a.error("\u521d\u59cb\u5316\u4f18\u60e0\u5238\u5931\u8d25")}var e}},n.a.createElement(x.a,{type:"link"},"\u521d\u59cb\u5316\u4f18\u60e0\u5238")))),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u6b63\u5728\u8fdb\u884c\u7684\u79d2\u6740"),n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:i.ongoing,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("img",{alt:"product",src:e.imgs[0]}),title:e.name,onClick:()=>p(e._id)},"\u4ef7\u683c: ".concat(e.price,"\uffe5"),n.a.createElement("br",null),"\u79d2\u6740\u7ed3\u675f\u65f6\u95f4: ".concat(new Date(e.seckillEnd).toLocaleString()),n.a.createElement("br",null),"\u5269\u4f59\u65f6\u95f4: ".concat(u(e.seckillEnd))))})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u5373\u5c06\u5f00\u59cb\u7684\u79d2\u6740"),n.a.createElement(fe.a,{grid:{gutter:16,column:2},dataSource:i.upcoming,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("img",{alt:"product",src:e.imgs[0]}),title:e.name,onClick:()=>p(e._id)},"\u4ef7\u683c: ".concat(e.price,"\uffe5"),n.a.createElement("br",null),"\u79d2\u6740\u5f00\u59cb\u65f6\u95f4: ".concat(new Date(e.seckillStart).toLocaleString()),n.a.createElement("br",null),"\u5012\u8ba1\u65f6: ".concat(u(e.seckillStart))))})),n.a.createElement("span",{style:{fontSize:20,fontWeight:700}},"\u7cbe\u9009\u597d\u7269"),n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:s,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{hoverable:!0,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"},cover:n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"20px"}},n.a.createElement("img",{alt:"product",src:e.imgs[0],style:{borderRadius:20}})),onClick:()=>p(e._id)},n.a.createElement(ve.a,{title:n.a.createElement("div",{style:{textAlign:"center"}},"".concat(e.name)),description:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement("div",null,"\u63cf\u8ff0: ".concat(e.desc)),n.a.createElement("br",null),n.a.createElement("div",{style:{fontSize:20,fontWeight:700,color:"#f00"}},"".concat(e.price,"\uffe5")))})))})))})),we=(a(175),a(97));a(212);const{Meta:ke}=ye.a;var Ce=Object(i.i)(e=>{let{history:t}=e;const[a,s]=Object(r.useState)([]),[c,l]=Object(r.useState)(null),o=Object(r.useRef)(null);Object(r.useEffect)(()=>{(async()=>{try{const e=await L({parentId:"0"});if(0===e.status){s(e.data);const t=e.data[0];if(t){const e=await L({parentId:t._id});0===e.status?l({...t,items:e.data}):C.a.error("\u83b7\u53d6\u5b50\u5206\u7c7b\u5217\u8868\u5931\u8d25")}}else C.a.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25")}})()},[]);return n.a.createElement("div",{className:"main-content"},n.a.createElement("div",{className:"page-content",style:{display:"flex",marginRight:"5%",marginLeft:"5%",height:"100vh"}},n.a.createElement(ne.b,{activeKey:null===c||void 0===c?void 0:c._id,onChange:e=>{(async e=>{try{const t=await L({parentId:e._id});0===t.status?l({...e,items:t.data}):C.a.error("\u83b7\u53d6\u5b50\u5206\u7c7b\u5217\u8868\u5931\u8d25")}catch(t){C.a.error("\u83b7\u53d6\u5b50\u5206\u7c7b\u5217\u8868\u5931\u8d25")}})(a.find(t=>t._id===e))},style:{backgroundColor:"white",boxShadow:"2px 0 5px rgba(0,0,0,0.1)",width:"20%",borderRadius:"4px",overflowY:"auto"}},a.map(e=>n.a.createElement(ne.b.Item,{key:e._id,title:e.name,style:{padding:"10px 20px",fontSize:"16px",transition:"background 0.3s, color 0.3s",backgroundColor:(null===c||void 0===c?void 0:c._id)===e._id?"#1890ff":"white",color:(null===c||void 0===c?void 0:c._id)===e._id?"white":"rgba(0, 0, 0, 0.85)",cursor:"pointer",borderRadius:"4px",marginBottom:"10px"},onMouseEnter:t=>{(null===c||void 0===c?void 0:c._id)!==e._id&&(t.currentTarget.style.backgroundColor="#e6f7ff")},onMouseLeave:t=>{(null===c||void 0===c?void 0:c._id)!==e._id&&(t.currentTarget.style.backgroundColor="white")}}))),n.a.createElement("div",{style:{width:"80%",padding:"0 10px",backgroundColor:"white",overflowY:"auto"},ref:o},c&&n.a.createElement(ye.a,{bordered:!1,style:{margin:"0"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},c.name),n.a.createElement(we.a,null),n.a.createElement(fe.a,{grid:{gutter:16,xs:2,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:c.items||[],renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{hoverable:!0,cover:n.a.createElement("img",{style:{borderRadius:10},src:e.imageUrl,alt:e.name}),style:{borderRadius:10},onClick:()=>(e=>{t.push({pathname:"/mainpage/products",state:{categoryId:e._id}})})(e)},n.a.createElement(ke,{title:n.a.createElement("div",{style:{textAlign:"center",fontWeight:"bold",fontSize:12}},e.name)})))})))))}),_e=(a(536),a(241)),Oe=(a(538),a(182));var je=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(e=>{let{history:t,userInfo:a}=e;const[s,c]=Object(r.useState)([]),[l,o]=Object(r.useState)([]);Object(r.useEffect)(()=>{const e=a._id;(async()=>{try{const a=await(t={userId:e},R("/cart","GET",t));c(a.data.products||[]),o(new Array(a.data.products.length).fill(!1))}catch(a){C.a.error("\u83b7\u53d6\u8d2d\u7269\u8f66\u4fe1\u606f\u5931\u8d25")}var t})()},[a]);const i=e=>t=>{const a=[...l];a[e]=t.target.checked,o(a)},d=e=>async t=>{const r=[...s];r[e].quantity=t,c(r);const{productId:n,name:l,desc:o}=r[e],i=a._id;try{await(d={userId:i,productId:n,name:l,desc:o,quantity:t},R("/cart/update","POST",d)),C.a.success("\u66f4\u65b0\u8d2d\u7269\u8f66\u6210\u529f")}catch(m){C.a.error("\u66f4\u65b0\u8d2d\u7269\u8f66\u5931\u8d25")}var d},m=e=>async()=>{const t=[...s],{productId:r}=t[e],n=a._id;try{await(l={userId:n,productId:r},R("/cart/delete","POST",l)),t.splice(e,1),c(t),C.a.success("\u5220\u9664\u8d2d\u7269\u8f66\u5546\u54c1\u6210\u529f")}catch(o){C.a.error("\u5220\u9664\u8d2d\u7269\u8f66\u5546\u54c1\u5931\u8d25")}var l},u=s.reduce((e,t,a)=>l[a]?e+t.price*t.quantity:e,0),p=n.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},n.a.createElement("div",null,"\u8d2d\u7269\u8f66"),n.a.createElement(Oe.a,{onChange:e=>{o(s.map(()=>e.target.checked))}},"\u5168\u9009"));return n.a.createElement(ye.a,{title:p},n.a.createElement(fe.a,{dataSource:s,renderItem:(e,t)=>n.a.createElement(fe.a.Item,null,n.a.createElement("div",{style:{width:"100%"}},n.a.createElement(ne.c,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},n.a.createElement(ne.c,{style:{display:"flex",alignItems:"center"}},n.a.createElement(Oe.a,{checked:l[t],onChange:i(t),style:{display:"flex",alignItems:"center"}},e.title),n.a.createElement("img",{src:e.imgs[0],alt:e.name,style:{width:"50px",marginRight:"10px"}}),n.a.createElement("div",null,n.a.createElement("span",{style:{fontWeight:700}},"\u540d\u79f0: ",e.name),n.a.createElement("br",null),"\u5355\u4ef7: ",e.price,n.a.createElement("br",null),"\u6570\u91cf: ",e.quantity)),n.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},n.a.createElement(ne.c,{direction:"vertical",align:"center"},n.a.createElement(_e.a,{size:"small",style:{width:50},min:1,max:10,value:e.quantity,onChange:d(t)}),n.a.createElement(x.a,{size:"small",type:"danger",onClick:m(t)},"\u5220\u9664")))),n.a.createElement(we.a,null)))}),n.a.createElement("div",{className:"cart-footer",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},n.a.createElement("div",null,"\u603b\u4ef7: ",u," \u5143"),n.a.createElement(x.a,{type:"default",onClick:async()=>{const e=s.filter((e,t)=>l[t]),r=e.reduce((e,t)=>e+t.price*t.quantity,0),n=r;var i;if(0!==e.length)try{const s=await N({userId:a._id,products:e,totalAmount:r,originalAmount:n});0===s.status?(await(i={userId:a._id},R("/cart/clear","POST",i)),c([]),o([]),t.push({pathname:"/checkout",state:{products:e,totalAmount:r,orderId:s.data._id,originalAmount:n}})):C.a.error("\u521b\u5efa\u8ba2\u5355\u5931\u8d25")}catch(d){C.a.error("\u521b\u5efa\u8ba2\u5355\u5931\u8d25")}else C.a.warning("\u8bf7\u9009\u62e9\u81f3\u5c11\u4e00\u4e2a\u5546\u54c1")}},"\u53bb\u7ed3\u7b97")))})),Te=(a(540),a(66)),Ae=(a(542),a(237)),De=a(559);var Re=Object(De.a)({scriptUrl:"//at.alicdn.com/t/c/font_4568414_gyf98qfv7hi.js"});a(545);var Le=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(e=>{let{history:t,userInfo:a}=e;const[s,c]=Object(r.useState)([]),[l,o]=Object(r.useState)([]),[i,d]=Object(r.useState)([]),[m,u]=Object(r.useState)(window.innerWidth),p=m<768?30:50;Object(r.useEffect)(()=>{const e=()=>{u(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),Object(r.useEffect)(()=>{h(),g(),E()},[]);const h=async()=>{try{const e=await R("/coupons/available","GET");0===e.status?c(e.data):C.a.error("\u83b7\u53d6\u53ef\u9886\u53d6\u4f18\u60e0\u5238\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u53ef\u9886\u53d6\u4f18\u60e0\u5238\u5931\u8d25")}},g=async()=>{try{const e=await F({userId:a._id});0===e.status?o(e.data):C.a.error("\u83b7\u53d6\u7528\u6237\u4f18\u60e0\u5238\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u7528\u6237\u4f18\u60e0\u5238\u5931\u8d25")}},E=async()=>{const e=a._id;try{const a=await(t={userId:e},R("/order","GET",t));d(a.data)}catch(r){C.a.error("\u83b7\u53d6\u8ba2\u5355\u4fe1\u606f\u5931\u8d25")}var t},y=async e=>{try{0===(await(t={userId:a._id,couponId:e},R("/coupon/claim","POST",t))).status?(C.a.success("\u4f18\u60e0\u5238\u9886\u53d6\u6210\u529f"),h(),g()):C.a.error("\u9886\u53d6\u4f18\u60e0\u5238\u5931\u8d25")}catch(r){C.a.error("\u9886\u53d6\u4f18\u60e0\u5238\u5931\u8d25")}var t},f=[{title:"\u5168\u90e8",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-dingdan"}),status:"all"},{title:"\u6536\u8d27",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-daishouhuo"}),status:"\u5f85\u6536\u8d27"},{title:"\u9000\u6362",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-tuihuanshenqing"}),status:"\u9000\u6b3e/\u552e\u540e"},{title:"\u5f85\u4ed8\u6b3e",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-daifukuan"}),status:"\u5f85\u4ed8\u6b3e"},{title:"\u5f85\u53d1\u8d27",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-a-daifahuo2x"}),status:"\u5f85\u53d1\u8d27"},{title:"\u5df2\u53d6\u6d88",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-yiquxiao"}),status:"\u5df2\u53d6\u6d88"}],b=[{title:"\u8db3\u8ff9",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-wodezuji"}),page:"/footprint"},{title:"\u6536\u85cf",icon:n.a.createElement(Re,{style:{fontSize:p},type:"icon-shoucang"}),page:"/favorite"}],v=s.filter(e=>!e.isClaimed),I=l.filter(e=>e.isClaimed);return n.a.createElement("div",{style:{backgroundColor:"#F4F5F9",marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement(ne.c,{direction:"vertical",style:{width:"100%"}},n.a.createElement(ye.a,{bordered:!1,style:{marginTop:16,borderRadius:10,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement(ve.a,{avatar:n.a.createElement(Ae.a,{src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"}),title:"\u4f1a\u5458",description:"\u79ef\u5206\uff1a ".concat(a.points,"   \u6210\u957f\u503c\uff1a").concat(a.growth)})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u6211\u7684\u8ba2\u5355"),n.a.createElement(fe.a,{style:{width:"100%"},grid:{gutter:16,xs:3,sm:4,md:6,lg:6,xl:6,xxl:6},dataSource:f,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{bordered:!1,onClick:()=>(e=>{const a="all"===e?i:i.filter(t=>"\u9000\u6b3e/\u552e\u540e"===e?t.status.includes("\u9000\u6b3e")||t.status.startsWith("\u552e\u540e\u5904\u7406\u4e2d"):t.status===e);t.push({pathname:"/order",state:{orders:a}})})(e.status),style:{textAlign:"center"}},e.icon,n.a.createElement("p",{style:{marginTop:20}},e.title)))})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u66f4\u591a\u529f\u80fd"),n.a.createElement(fe.a,{grid:{gutter:16,xs:3,sm:4,md:4,lg:6,xl:6,xxl:6},dataSource:b,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{onClick:()=>{return a=e.page,void t.push(a);var a},bordered:!1,style:{textAlign:"center",margin:"0px",padding:"0px"}},e.icon,n.a.createElement("p",{style:{marginTop:20}},e.title)))})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u5f85\u9886\u53d6\u4f18\u60e0\u5238"),n.a.createElement(fe.a,{itemLayout:"vertical",dataSource:v,renderItem:e=>n.a.createElement(fe.a.Item,{key:e._id},n.a.createElement(ye.a,{style:{borderRadius:10,position:"relative"}},n.a.createElement("div",{style:{position:"absolute",top:50,right:30}},n.a.createElement(x.a,{onClick:()=>y(e._id),icon:"plus",type:"danger"})),n.a.createElement("div",{style:{flex:1}},n.a.createElement(Te.a,{title:"\u4f18\u60e0\u5238\u4ee3\u7801: ".concat(e.code)},n.a.createElement(Te.a.Item,{label:"\u4f18\u60e0\u91d1\u989d"},"\xa5",e.discount),n.a.createElement(Te.a.Item,{label:"\u6700\u4f4e\u6d88\u8d39"},"\xa5",e.minSpend),n.a.createElement(Te.a.Item,{label:"\u6709\u6548\u671f"},new Date(e.expiryDate).toLocaleDateString())))))})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u6211\u7684\u4f18\u60e0\u5238"),n.a.createElement(fe.a,{itemLayout:"vertical",dataSource:I,renderItem:e=>n.a.createElement(fe.a.Item,{key:e._id},n.a.createElement(ye.a,{style:{borderRadius:10}},n.a.createElement(Te.a,{title:"\u4f18\u60e0\u5238\u4ee3\u7801\uff1a ".concat(e.code),column:{xxl:4,xl:4,lg:2,md:2,sm:2,xs:1}},n.a.createElement(Te.a.Item,null,"\u4f18\u60e0\u91d1\u989d\uff1a \xa5",e.discount),n.a.createElement(Te.a.Item,null,"\u6700\u4f4e\u6d88\u8d39\uff1a \xa5",e.minSpend),n.a.createElement(Te.a.Item,null,"\u6709\u6548\u671f\uff1a",new Date(e.expiryDate).toLocaleDateString()),n.a.createElement(Te.a.Item,null,"\u72b6\u6001\uff1a",e.isClaimed?"\u5df2\u9886\u53d6":"\u672a\u9886\u53d6"))))}))))})),ze=(a(129),a(73));const{Text:Pe}=ze.a;var Ue=Object(i.i)(e=>{var t;let{history:a,location:s}=e;const[c,l]=Object(r.useState)(1),[o,i]=Object(r.useState)([]),[d,m]=Object(r.useState)(0),[u,p]=Object(r.useState)(!1),[h,g]=Object(r.useState)((null===(t=s.state)||void 0===t?void 0:t.categoryId)||""),[E,y]=Object(r.useState)([]),[f,b]=Object(r.useState)({ongoing:[],upcoming:[]});Object(r.useEffect)(()=>{v(1),I(),x()},[h]),Object(r.useEffect)(()=>{const e=setInterval(()=>{x()},1e3);return()=>clearInterval(e)},[]);const v=async e=>{p(!0);try{const a=await(t={pageNum:e,pageSize:5,categoryId:h},R("/manage/product/list","GET",t));if(0===a.status){const{total:e,list:t}=a.data,r=t.filter(e=>1===e.status);r.forEach(e=>e.price=(e=>{const t=(e+="").split("."),a="-"===t[0].charAt(0)?"-":"";let r=a?t[0].slice(1):t[0],n="";for(;r.length>3;)n=",".concat(r.slice(-3)).concat(n),r=r.slice(0,r.length-3);return r&&(n=r+n),"".concat(a).concat(n).concat(t[1]?".".concat(t[1]):"")})(e.price)),i(r),m(r.length)}else C.a.error("\u83b7\u53d6\u5546\u54c1\u5217\u8868\u5931\u8d25")}catch(a){C.a.error("\u83b7\u53d6\u5546\u54c1\u5217\u8868\u5931\u8d25")}var t;p(!1)},I=async()=>{try{const e=await z();0===e.status?y(e.data):C.a.error("\u83b7\u53d6\u70ed\u95e8\u5546\u54c1\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u70ed\u95e8\u5546\u54c1\u5931\u8d25")}},x=async()=>{try{const e=await q();0===e.status?b(e.data):C.a.error("\u83b7\u53d6\u79d2\u6740\u5546\u54c1\u5931\u8d25")}catch(e){C.a.error("\u83b7\u53d6\u79d2\u6740\u5546\u54c1\u5931\u8d25")}},S=e=>{a.push({pathname:"/mainpage/product/detail",state:{productId:e}})},w=e=>{const t=Math.floor((new Date(e)-new Date)/1e3),a=Math.floor(t/3600),r=Math.floor(t%3600/60),n=t%60;return"".concat(a,"\u5c0f\u65f6 ").concat(r,"\u5206\u949f ").concat(n,"\u79d2")};return n.a.createElement("div",{style:{padding:"0 5%"}},n.a.createElement(ne.c,{direction:"vertical",style:{width:"100%"}},n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u6b63\u5728\u8fdb\u884c\u7684\u79d2\u6740"),n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:f.ongoing,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("img",{alt:"product",src:e.imgs[0]}),title:e.name,onClick:()=>S(e._id)},"\u4ef7\u683c: ".concat(e.price,"\uffe5"),n.a.createElement("br",null),"\u79d2\u6740\u7ed3\u675f\u65f6\u95f4: ".concat(new Date(e.seckillEnd).toLocaleString()),n.a.createElement("br",null),"\u5269\u4f59\u65f6\u95f4: ".concat(w(e.seckillEnd))))})),n.a.createElement(ye.a,{bordered:!1,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"}},n.a.createElement("h1",{style:{fontSize:20,fontWeight:700}},"\u5373\u5c06\u5f00\u59cb\u7684\u79d2\u6740"),n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:f.upcoming,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("img",{alt:"product",src:e.imgs[0]}),title:e.name,onClick:()=>S(e._id)},"\u4ef7\u683c: ".concat(e.price,"\uffe5"),n.a.createElement("br",null),"\u79d2\u6740\u5f00\u59cb\u65f6\u95f4: ".concat(new Date(e.seckillStart).toLocaleString()),n.a.createElement("br",null),"\u5012\u8ba1\u65f6: ".concat(w(e.seckillStart))))})),n.a.createElement("br",null),n.a.createElement("h1",{style:{fontSize:24,fontWeight:700}},"\u7cbe\u9009\u597d\u7269"),n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:4},dataSource:E,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{hoverable:!0,style:{borderRadius:20,boxShadow:"2px 0 5px rgba(0,0,0,0.1)"},cover:n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"20px"}},n.a.createElement("img",{alt:"product",src:e.imgs[0],style:{borderRadius:20}})),onClick:()=>S(e._id)},n.a.createElement(ye.a.Meta,{title:n.a.createElement("div",{style:{textAlign:"center"}},"".concat(e.name)),description:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement("div",null,"\u63cf\u8ff0: ".concat(e.desc)),n.a.createElement("br",null),n.a.createElement("div",{style:{fontSize:20,fontWeight:700,color:"#f00"}},"".concat(e.price,"\uffe5")))})))})))}),Ne=a(557);const{Text:Me}=ze.a,Fe={fontSize:15,marginRight:"1rem"};class qe extends n.a.Component{constructor(e){super(e),this.fetchProductDetails=async()=>{const{productId:e}=this.props.location.state;try{const a=await(e=>R("/product/".concat(e),"GET"))(e);0===a.status?(this.setState({product:a.data},this.startCountdown),await(t={userId:this.props.userInfo._id,productId:e},R("/footprint/add","POST",t))):C.a.error(a.msg||"\u83b7\u53d6\u5546\u54c1\u8be6\u60c5\u5931\u8d25")}catch(a){C.a.error("\u83b7\u53d6\u5546\u54c1\u8be6\u60c5\u5931\u8d25")}var t},this.startCountdown=()=>{const{seckillStart:e,seckillEnd:t}=this.state.product;if(!e||!t)return;const a=new Date(e).getTime(),r=new Date(t).getTime();this.countdownInterval=setInterval(()=>{const e=(new Date).getTime();if(e<a){const t=a-e,r=Math.floor(t%864e5/36e5),n=Math.floor(t%36e5/6e4),s=Math.floor(t%6e4/1e3);this.setState({countdown:"\u79d2\u6740\u672a\u5f00\u59cb\uff0c\u5012\u8ba1\u65f6: ".concat(r,"\u5c0f\u65f6 ").concat(n,"\u5206\u949f ").concat(s,"\u79d2"),isSeckillActive:!1,seckillStatus:"not_started"})}else if(e>=a&&e<=r){const t=r-e,a=Math.floor(t%864e5/36e5),n=Math.floor(t%36e5/6e4),s=Math.floor(t%6e4/1e3);this.setState({countdown:"\u79d2\u6740\u8fdb\u884c\u4e2d\uff0c\u5269\u4f59\u65f6\u95f4: ".concat(a,"\u5c0f\u65f6 ").concat(n,"\u5206\u949f ").concat(s,"\u79d2"),isSeckillActive:!0,seckillStatus:"ongoing"})}else clearInterval(this.countdownInterval),this.setState({countdown:"\u79d2\u6740\u5df2\u7ed3\u675f",isSeckillActive:!1,seckillStatus:"ended"})},1e3)},this.goBack=()=>{this.props.history.goBack()},this.handleBuyNow=async()=>{const{_id:e,name:t,imgs:a,desc:r,price:n}=this.state.product,{userInfo:s}=this.props,c=[{productId:e,name:t,imgs:a,desc:r,quantity:1,price:n}],l=n,o=l;try{const e=await N({userId:s._id,products:c,totalAmount:l,originalAmount:o});0===e.status?this.props.history.push({pathname:"/checkout",state:{products:c,totalAmount:l,orderId:e.data._id,originalAmount:o}}):C.a.error("\u521b\u5efa\u8ba2\u5355\u5931\u8d25")}catch(i){C.a.error("\u521b\u5efa\u8ba2\u5355\u5931\u8d25")}},this.handleSeckill=async()=>{const{_id:e}=this.state.product,{userInfo:t}=this.props;try{const r=await(a={productId:e,userId:t._id},R("/seckill","POST",a));if(0===r.status){C.a.success("\u79d2\u6740\u6210\u529f");const{orderId:t}=r,a=[{productId:e,name:this.state.product.name,desc:this.state.product.desc,quantity:1,price:this.state.product.seckillPrice}],n=this.state.product.seckillPrice,s=n;this.props.history.push({pathname:"/checkout",state:{products:a,totalAmount:n,orderId:t,originalAmount:s}})}else C.a.error(r.msg||"\u79d2\u6740\u5931\u8d25")}catch(r){C.a.error("\u79d2\u6740\u5931\u8d25")}var a},this.handleAddToCart=async()=>{const{_id:e,name:t,desc:a,price:r,imgs:n}=this.state.product,{userInfo:s}=this.props;try{await(c={userId:s._id,productId:e,name:t,desc:a,quantity:1,price:r,imgs:n},R("/cart/add","POST",c)),C.a.success("\u5546\u54c1\u5df2\u52a0\u5165\u8d2d\u7269\u8f66")}catch(l){C.a.error("\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66\u5931\u8d25")}var c},this.handleAddToFavorites=async()=>{const{_id:e}=this.state.product,{userInfo:t}=this.props;try{await(a={userId:t._id,productId:e},R("/favorite/add","POST",a)),C.a.success("\u5546\u54c1\u5df2\u6536\u85cf")}catch(r){C.a.error("\u6536\u85cf\u5546\u54c1\u5931\u8d25")}var a},this.handleHome=()=>{this.props.history.push("/mainpage/home")},this.handleCart=()=>{this.props.history.push("/mainpage/cart")},this.state={product:null,countdown:null,isSeckillActive:!1,seckillStatus:""},this.title=n.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"0 10"}},n.a.createElement(k.a,{type:"arrow-left",onClick:this.goBack,style:{fontSize:20}}),n.a.createElement(Ne.a,{onClick:this.handleAddToFavorites,style:{fontSize:20}}))}componentDidMount(){this.fetchProductDetails()}componentWillUnmount(){this.countdownInterval&&clearInterval(this.countdownInterval)}render(){const{product:e,countdown:t,isSeckillActive:a,seckillStatus:r}=this.state;if(!e)return n.a.createElement("p",null,"\u52a0\u8f7d\u4e2d...");const s=["\u5546\u54c1\u540d\u79f0","\u5546\u54c1\u63cf\u8ff0","\u5546\u54c1\u4ef7\u683c","\u5546\u54c1\u8be6\u60c5"];return n.a.createElement(ye.a,{title:this.title,style:{marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement("img",{src:e.imgs[0],alt:e.name,style:{width:"100%",marginBottom:"1rem"}}),n.a.createElement(fe.a,{bordered:!0},n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},s[0],":"),e.name),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},s[1],":"),e.desc),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},s[2],":"),"\xa5",e.price),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},s[3],":"),e.detail),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u8bbf\u95ee\u91cf:"),e.visitCount),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u6536\u85cf\u91cf:"),e.favoriteCount),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u6210\u4ea4\u91cf:"),e.orderCount),e.seckillPrice&&n.a.createElement(n.a.Fragment,null,n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u79d2\u6740\u4ef7\u683c:"),"\xa5",e.seckillPrice),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u79d2\u6740\u5e93\u5b58:"),e.seckillStock),n.a.createElement(fe.a.Item,null,n.a.createElement(Me,{style:Fe},"\u79d2\u6740\u72b6\u6001:"),t))),n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:10,margin:10}},n.a.createElement(ne.c,null,n.a.createElement(x.a,{type:"default",onClick:this.handleBuyNow},"\u7acb\u5373\u8d2d\u4e70"),n.a.createElement(x.a,{type:"default",onClick:this.handleAddToCart},"\u52a0\u5165\u8d2d\u7269\u8f66"),e.seckillPrice&&n.a.createElement(x.a,{type:"danger",onClick:this.handleSeckill,disabled:!a},"\u79d2\u6740\u62a2\u8d2d"))))}}var We=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(qe)),Be=(a(220),a(77));const{Text:Ge}=ze.a,{Option:He}=Be.a;class Ye extends n.a.Component{constructor(){super(...arguments),this.state={products:[],totalAmount:0,originalAmount:0,orderId:null,coupons:[],selectedCoupon:null,discount:0},this.fetchUserCoupons=async()=>{const{userInfo:e}=this.props;try{const t=await F({userId:e._id});0===t.status?this.setState({coupons:t.data}):C.a.error("\u83b7\u53d6\u7528\u6237\u4f18\u60e0\u5238\u5931\u8d25")}catch(t){C.a.error("\u83b7\u53d6\u7528\u6237\u4f18\u60e0\u5238\u5931\u8d25")}},this.handleConfirmPayment=async()=>{const{orderId:e,selectedCoupon:t,totalAmount:a,discount:r}=this.state,n=a-r;try{0===(await(s={orderId:e,couponId:t,finalAmount:n},R("/order/confirm","POST",s))).status?(C.a.success("\u652f\u4ed8\u6210\u529f"),await(e=>R("/coupon/use","POST",e))({userId:this.props.userInfo._id,couponId:t}),this.props.history.push({pathname:"/order-confirmed",state:{totalAmount:n,orderId:this.state.orderId}})):C.a.error("\u652f\u4ed8\u5931\u8d25")}catch(c){C.a.error("\u652f\u4ed8\u5931\u8d25")}var s},this.handleCouponChange=e=>{const t=this.state.coupons.find(t=>t._id===e),a=t?t.discount:0;this.setState({selectedCoupon:e,discount:a})},this.handleBack=()=>{this.props.history.push("/mainpage/cart")}}componentDidMount(){const{location:e}=this.props;e.state&&e.state.products&&e.state.products.length>0?(this.setState({products:e.state.products,totalAmount:e.state.totalAmount,originalAmount:e.state.originalAmount,orderId:e.state.orderId}),this.fetchUserCoupons()):(C.a.error("\u672a\u80fd\u83b7\u53d6\u8ba2\u5355\u4fe1\u606f\uff0c\u8bf7\u8fd4\u56de\u8d2d\u7269\u8f66\u91cd\u65b0\u7ed3\u7b97"),this.props.history.push("/mainpage/cart"))}render(){const{products:e,totalAmount:t,originalAmount:a,orderId:r,coupons:s,discount:c}=this.state,l=t-c;return n.a.createElement(ye.a,{title:"\u652f\u4ed8\u9875\u9762"},n.a.createElement("p",null,"\u8ba2\u5355\u53f7: ",r),n.a.createElement("p",null,"\u5546\u54c1\u5217\u8868:"),n.a.createElement("ul",null,e.map((e,t)=>n.a.createElement("li",{key:t},n.a.createElement(ne.c,null,n.a.createElement("img",{src:e.imgs[0],alt:e.name,style:{width:"80px",marginRight:"10px"}}),n.a.createElement(ne.c,{direction:"vertical"},n.a.createElement("span",{style:{fontWeight:700}},e.name),n.a.createElement("span",null,"\u63cf\u8ff0: ",e.desc),n.a.createElement(ne.c,null,n.a.createElement("span",null,"\u6570\u91cf: ",e.quantity),n.a.createElement("span",null,"\u4ef7\u683c: \xa5",e.price)))),n.a.createElement(we.a,null)))),n.a.createElement(Be.a,{placeholder:"\u9009\u62e9\u4f18\u60e0\u5238",style:{width:"100%",marginBottom:"1rem"},onChange:this.handleCouponChange},s.map(e=>n.a.createElement(He,{key:e._id,value:e._id,disabled:a<e.minSpend},e.code," - \u6ee1",e.minSpend,"\u51cf",e.discount," (\u6709\u6548\u671f: ",new Date(e.expiryDate).toLocaleDateString(),")"))),n.a.createElement(ne.c,{direction:"vertical"},n.a.createElement("span",null,"\u4f18\u60e0\u91d1\u989d: \xa5",c),n.a.createElement("span",null,"\u5e94\u4ed8\u91d1\u989d: \xa5",l)),n.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",margin:20}},n.a.createElement(x.a,{type:"default",onClick:this.handleBack},"\u8fd4\u56de\u8d2d\u7269\u8f66"),n.a.createElement(x.a,{type:"default",onClick:this.handleConfirmPayment},"\u786e\u8ba4\u652f\u4ed8")))}}var Ve=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(Ye));var Ze=Object(i.i)(e=>{let{history:t,location:a}=e;const{totalAmount:r}=a.state||{};return n.a.createElement(ye.a,{title:"\u8ba2\u5355\u786e\u8ba4",style:{marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement("p",null,"\u60a8\u7684\u8ba2\u5355\u5df2\u6210\u529f\u652f\u4ed8\uff01"),n.a.createElement("p",null,"\u652f\u4ed8\u91d1\u989d: \xa5",r),n.a.createElement("div",null,n.a.createElement(x.a,{type:"primary",onClick:()=>{t.push("/mainpage/home")}},"\u8fd4\u56de\u9996\u9875"),n.a.createElement(x.a,{type:"default",onClick:()=>{t.push({pathname:"/order-details",state:{orderId:a.state.orderId}})}},"\u67e5\u770b\u8ba2\u5355")))}),Ke=a(558);class Xe extends n.a.Component{constructor(){super(...arguments),this.state={orders:[]},this.handleOrderClick=e=>{this.props.history.push({pathname:"/order-details",state:{orderId:e}})},this.handleBack=()=>{this.props.history.goBack()}}componentDidMount(){const{location:e}=this.props,t=e.state&&e.state.orders;t&&this.setState({orders:t})}render(){const{orders:e}=this.state;return n.a.createElement("div",{style:{marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement(Ke.a,{onClick:this.handleBack,style:{fontSize:25}}),n.a.createElement(ye.a,{title:"\u6240\u6709\u8ba2\u5355"},n.a.createElement(fe.a,{itemLayout:"vertical",dataSource:e,renderItem:e=>n.a.createElement(fe.a.Item,{key:e._id,onClick:()=>this.handleOrderClick(e._id)},n.a.createElement(fe.a.Item.Meta,{title:"\u8ba2\u5355\u53f7: ".concat(e._id),description:"\u4f18\u60e0\u524d: \xa5".concat(e.originalAmount," | \u5b9e\u9645\u652f\u4ed8: \xa5").concat(e.totalAmount," | \u72b6\u6001: ").concat(e.status)}))})))}}var $e=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Xe),Je=(a(549),a(150));const{Text:Qe}=ze.a,{confirm:et}=re.a;class tt extends n.a.Component{constructor(){super(...arguments),this.state={orderId:this.props.location.state.orderId||"",order:{},products:[],afterSalesType:""},this.fetchOrderDetails=async()=>{const{orderId:e}=this.state;if(e){const t=await(e=>R("/order/".concat(e),"GET"))(e);0===t.status?this.setState({order:t.data,products:t.data.products}):C.a.error("\u83b7\u53d6\u8ba2\u5355\u8be6\u60c5\u5931\u8d25")}},this.handlePayment=()=>{const{products:e,orderId:t}=this.state,a=e.reduce((e,t)=>e+t.price*t.quantity,0);this.props.history.push({pathname:"/checkout",state:{products:e,totalAmount:a,orderId:t}})},this.handleCancelOrder=async()=>{const{orderId:e}=this.state,t=await(a={orderId:e},R("/order/cancel","POST",a));var a;0===t.status?(C.a.success("\u8ba2\u5355\u5df2\u53d6\u6d88"),this.setState({order:{...this.state.order,status:"\u5df2\u53d6\u6d88"}})):C.a.error(t.msg||"\u53d6\u6d88\u8ba2\u5355\u5931\u8d25")},this.handleConfirmReceipt=async()=>{const{orderId:e}=this.state;try{0===(await M({orderId:e,status:"\u4ea4\u6613\u6210\u529f"})).status?(C.a.success("\u5df2\u786e\u8ba4\u6536\u8d27"),this.setState({order:{...this.state.order,status:"\u4ea4\u6613\u6210\u529f"}})):C.a.error("\u786e\u8ba4\u6536\u8d27\u5931\u8d25")}catch(t){C.a.error("\u786e\u8ba4\u6536\u8d27\u5931\u8d25")}},this.handleRequestAfterSales=()=>{et({title:"\u9009\u62e9\u552e\u540e\u7c7b\u578b",content:n.a.createElement(Je.a.Group,{onChange:e=>this.setState({afterSalesType:e.target.value})},n.a.createElement(Je.a,{value:"\u4ec5\u9000\u6b3e"},"\u4ec5\u9000\u6b3e"),n.a.createElement(Je.a,{value:"\u9000\u8d27\u9000\u6b3e"},"\u9000\u8d27\u9000\u6b3e")),onOk:async()=>{const{orderId:e,afterSalesType:t}=this.state;try{0===(await M({orderId:e,status:"\u552e\u540e\u5904\u7406\u4e2d(".concat(t,")")})).status?(C.a.success("\u552e\u540e\u8bf7\u6c42\u5df2\u63d0\u4ea4"),this.setState({order:{...this.state.order,status:"\u552e\u540e\u5904\u7406\u4e2d(".concat(t,")")}})):C.a.error("\u552e\u540e\u8bf7\u6c42\u63d0\u4ea4\u5931\u8d25")}catch(a){C.a.error("\u552e\u540e\u8bf7\u6c42\u63d0\u4ea4\u5931\u8d25")}},onCancel(){C.a.info("\u53d6\u6d88\u552e\u540e\u8bf7\u6c42")}})},this.handleReorder=async()=>{const{products:e}=this.state,{userInfo:t}=this.props,a=e.reduce((e,t)=>e+t.price*t.quantity,0);if(0!==e.length)try{const r=await N({userId:t._id,products:e,totalAmount:a});0===r.status?this.props.history.push({pathname:"/checkout",state:{products:e,totalAmount:a,orderId:r.data._id}}):C.a.error("\u91cd\u65b0\u4e0b\u5355\u5931\u8d25")}catch(r){C.a.error("\u91cd\u65b0\u4e0b\u5355\u5931\u8d25")}else C.a.warning("\u6ca1\u6709\u5546\u54c1\u53ef\u4ee5\u91cd\u65b0\u4e0b\u5355")}}componentDidMount(){this.fetchOrderDetails()}render(){const{orderId:e,products:t,order:a}=this.state,r=a.originalAmount,s=a.totalAmount;return n.a.createElement(ye.a,{title:"\u8ba2\u5355\u53f7: ".concat(e),style:{marginRight:" 5% ",marginLeft:" 5% "}},n.a.createElement(fe.a,{itemLayout:"vertical",dataSource:t,renderItem:e=>n.a.createElement(fe.a.Item,{key:e._id},n.a.createElement(fe.a.Item.Meta,{title:"\u5546\u54c1\u540d\uff1a".concat(e.name," | \u5546\u54c1\u63cf\u8ff0\uff1a").concat(e.desc),description:"\u4ef7\u683c: \xa5".concat(e.price," | \u6570\u91cf: ").concat(e.quantity)}),n.a.createElement("img",{src:e.imgs[0],alt:e.name,style:{width:"50px",marginTop:"10px"}}))}),n.a.createElement(Qe,null,"\u603b\u91d1\u989d: \xa5",r),n.a.createElement("br",null),n.a.createElement(Qe,null,"\u4f18\u60e0\u91d1\u989d: \xa5",r-s),n.a.createElement("br",null),n.a.createElement(Qe,null,"\u5e94\u4ed8\u91d1\u989d: \xa5",s),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(Qe,null,"\u8ba2\u5355\u72b6\u6001: ",a.status||"\u672a\u77e5\u72b6\u6001"),n.a.createElement("br",null),"\u5f85\u4ed8\u6b3e"===a.status&&n.a.createElement(n.a.Fragment,null,n.a.createElement(x.a,{type:"primary",onClick:this.handlePayment},"\u53bb\u652f\u4ed8"),n.a.createElement(x.a,{onClick:this.handleCancelOrder,style:{marginLeft:10}},"\u53d6\u6d88\u8ba2\u5355")),"\u5f85\u6536\u8d27"===a.status&&n.a.createElement(n.a.Fragment,null,n.a.createElement(x.a,{type:"primary",onClick:this.handleConfirmReceipt},"\u786e\u8ba4\u6536\u8d27"),n.a.createElement(x.a,{onClick:this.handleRequestAfterSales,style:{marginLeft:10}},"\u552e\u540e")),"\u4ea4\u6613\u6210\u529f"===a.status&&n.a.createElement(x.a,{type:"primary",onClick:this.handleRequestAfterSales},"\u552e\u540e"),a.status&&a.status.includes("\u672a\u901a\u8fc7")&&n.a.createElement(x.a,{type:"primary",onClick:this.handleRequestAfterSales},"\u518d\u6b21\u7533\u8bf7\u552e\u540e"),a.status&&a.status.includes("\u901a\u8fc7")&&null,"\u5df2\u53d6\u6d88"===a.status&&n.a.createElement(x.a,{type:"primary",onClick:this.handleReorder},"\u91cd\u65b0\u4e0b\u5355"))}}var at=Object(i.i)(Object(d.b)(e=>({userInfo:e.loginUserInfo}))(tt));var rt=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(e=>{let{history:t,userInfo:a}=e;const[s,c]=Object(r.useState)([]);Object(r.useEffect)(()=>{(async()=>{const e=a._id;try{const a=await(t={userId:e},R("/favorite","GET",t));0===a.status?c(a.data||[]):C.a.error(a.msg||"\u83b7\u53d6\u6536\u85cf\u4fe1\u606f\u5931\u8d25")}catch(r){C.a.error("\u83b7\u53d6\u6536\u85cf\u4fe1\u606f\u5931\u8d25")}var t})()},[a]);const l=async e=>{const t=a._id;try{await(r={userId:t,productId:e},R("/favorite/delete","POST",r)),c(s.filter(t=>t.productDetails._id!==e)),C.a.success("\u5220\u9664\u6536\u85cf\u5546\u54c1\u6210\u529f")}catch(n){C.a.error("\u5220\u9664\u6536\u85cf\u5546\u54c1\u5931\u8d25")}var r};return n.a.createElement(ye.a,{title:"\u6211\u7684\u6536\u85cf",style:{marginRight:"5%",marginLeft:"5%",marginTop:"20px"}},n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:s,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"10px"}},n.a.createElement("img",{src:e.productDetails.imgs[0],alt:e.productDetails.name,style:{borderRadius:5,maxHeight:"200px",objectFit:"cover"}})),style:{borderRadius:5,marginBottom:"10px"}},n.a.createElement(ve.a,{title:n.a.createElement("div",{style:{textAlign:"center"}},e.productDetails.name),description:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement("p",null,e.productDetails.desc),n.a.createElement("p",null,new Date(e.lastVisited).toLocaleString()))}),n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"10px"}},n.a.createElement(ne.c,null,n.a.createElement(x.a,{type:"default",onClick:()=>{return a=e.productDetails._id,void t.push({pathname:"/mainpage/product/detail/",state:{productId:a}});var a}},"\u8be6\u60c5"),n.a.createElement(x.a,{type:"danger",onClick:()=>l(e.productDetails._id)},"\u5220\u9664")))))}))}));var nt=Object(d.b)(e=>({userInfo:e.loginUserInfo}))(Object(i.i)(e=>{let{history:t,userInfo:a}=e;const[s,c]=Object(r.useState)([]);Object(r.useEffect)(()=>{(async()=>{const e=a._id;try{const a=await(t={userId:e},R("/footprint","GET",t));0===a.status?c(a.data||[]):C.a.error(a.msg||"\u83b7\u53d6\u8db3\u8ff9\u4fe1\u606f\u5931\u8d25")}catch(r){C.a.error("\u83b7\u53d6\u8db3\u8ff9\u4fe1\u606f\u5931\u8d25")}var t})()},[a]);const l=async e=>{const t=a._id;try{await(r={userId:t,productId:e},R("/footprint/delete","POST",r)),c(s.filter(t=>t.productDetails._id!==e)),C.a.success("\u5220\u9664\u8db3\u8ff9\u5546\u54c1\u6210\u529f")}catch(n){C.a.error("\u5220\u9664\u8db3\u8ff9\u5546\u54c1\u5931\u8d25")}var r};return n.a.createElement(ye.a,{title:"\u6211\u7684\u8db3\u8ff9",style:{marginRight:"5%",marginLeft:"5%",marginTop:"20px"}},n.a.createElement(fe.a,{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:3},dataSource:s,renderItem:e=>n.a.createElement(fe.a.Item,null,n.a.createElement(ye.a,{cover:n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"10px"}},n.a.createElement("img",{src:e.productDetails.imgs[0],alt:e.productDetails.name,style:{borderRadius:5,maxHeight:"200px",objectFit:"cover"}})),style:{borderRadius:5,marginBottom:"10px"}},n.a.createElement(ve.a,{title:n.a.createElement("div",{style:{textAlign:"center"}},e.productDetails.name),description:n.a.createElement("div",{style:{textAlign:"center"}},n.a.createElement("p",null,e.productDetails.desc),n.a.createElement("p",null,new Date(e.lastVisited).toLocaleString()))}),n.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:"10px"}},n.a.createElement(ne.c,null,n.a.createElement(x.a,{type:"default",onClick:()=>{return a=e.productDetails._id,void t.push({pathname:"/mainpage/product/detail",state:{productId:a}});var a}},"\u8be6\u60c5"),n.a.createElement(x.a,{type:"danger",onClick:()=>l(e.productDetails._id)},"\u5220\u9664")))))}))}));const{Footer:st,Content:ct}=ae.a;class lt extends r.Component{constructor(){super(...arguments),this.state={collapsed:!1}}render(){const{userInfo:e}=this.props;return e._id?n.a.createElement(ae.a,{style:{minHeight:"100%",backgroundColor:"#F4F5F9",margin:0}},n.a.createElement(ce,null),n.a.createElement(ct,{style:{background:"#F4F5F9",paddingBottom:20,marginTop:80}},n.a.createElement(r.Suspense,{fallback:n.a.createElement(he,null)},n.a.createElement(i.d,null,n.a.createElement(i.b,{path:"/mainpage/home",component:Se}),n.a.createElement(i.b,{path:"/mainpage/category",component:Ce}),n.a.createElement(i.b,{path:"/mainpage/cart",component:je}),n.a.createElement(i.b,{path:"/mainpage/my",component:Le}),n.a.createElement(i.b,{path:"/mainpage/products",component:Ue}),n.a.createElement(i.b,{path:"/mainpage/product/detail",component:We}),n.a.createElement(i.b,{path:"/checkout",component:Ve}),n.a.createElement(i.b,{path:"/order",component:$e}),n.a.createElement(i.b,{path:"/order-confirmed",component:Ze}),n.a.createElement(i.b,{path:"/order-details",component:at}),n.a.createElement(i.b,{path:"/favorite",component:rt}),n.a.createElement(i.b,{path:"/footprint",component:nt}),n.a.createElement(i.b,{component:Ee})))),n.a.createElement(st,{style:{textAlign:"center",background:"#F4F5F9"}},n.a.createElement(ue,null)),n.a.createElement(me,null),n.a.createElement(te.a,{visibilityHeight:100})):n.a.createElement(i.a,{to:"/login"})}}var ot=Object(d.b)(e=>({userInfo:e.loginUserInfo}),null)(lt);p.a.locale("zh-cn");class it extends r.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(e){return console.error(e),{hasError:!0}}render(){return this.state.hasError?n.a.createElement(he,null):this.props.children}}class dt extends r.Component{render(){const e=E.get("user_key");return E.user=e,n.a.createElement(d.a,{store:I},n.a.createElement(l.b,{locale:m.a},n.a.createElement(o.a,null,n.a.createElement(it,null,n.a.createElement(i.d,null,n.a.createElement(i.b,{exact:!0,path:"/login",component:X}),n.a.createElement(i.b,{exact:!0,path:"/register",component:ee}),n.a.createElement(i.b,{path:"/",component:ot}))))))}}var mt=dt;c.a.render(n.a.createElement(mt,null),document.getElementById("root"))}},[[314,1,2]]]);